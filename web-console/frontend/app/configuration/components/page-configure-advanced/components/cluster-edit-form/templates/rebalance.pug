

include /app/helpers/jade/mixins
include /app/configuration/mixins

-var form = 'rebalance'
-var model = '$ctrl.clonedCluster'

panel-collapsible(ng-show='$ctrl.available("2.5.0")' ng-form=form on-open=`ui.loadPanel('${form}')`)
    panel-title Rebalance
    panel-description
        | Rebalance settings.
        a.link-success(href="https://apacheignite.readme.io/docs/rebalancing" target="_blank") More info
    panel-content.pca-form-row(ng-if=`ui.isPanelLoaded('${form}')`)
        .pca-form-column-6.pc-form-grid-row
            .pc-form-grid-col-30
                +form-field__number({
                    label: 'Batch size:',
                    model: `${model}.rebalanceBatchSize`,
                    name: '"rebalanceBatchSize"',
                    placeholder: '512 * 1024',
                    min: '1',
                    tip: 'Size (in bytes) to be loaded within a single rebalance message<br/>\
                          Rebalancing algorithm will split total data set on every node into multiple batches prior to sending data'
                })
            .pc-form-grid-col-30
                +form-field__number({
                    label: 'Batches prefetch count:',
                    model: `${model}.rebalanceBatchesPrefetchCount`,
                    name: '"rebalanceBatchesPrefetchCount"',
                    placeholder: '2',
                    min: '1',
                    tip: 'Number of batches generated by supply node at rebalancing start'
                })
            .pc-form-grid-col-30
                +form-field__number({
                    label: 'Timeout:',
                    model: `${model}.rebalanceTimeout`,
                    name: '"rebalanceTimeout"',
                    placeholder: '10000',
                    min: '0',
                    tip: 'Rebalance timeout in milliseconds'
                })
            .pc-form-grid-col-30
                +form-field__number({
                    label: 'Throttle:',
                    model: `${model}.rebalanceThrottle`,
                    name: '"rebalanceThrottle"',
                    placeholder: '0',
                    min: '0',
                    tip: 'Time in milliseconds to wait between rebalance messages to avoid overloading of CPU or network'
                })

        .pca-form-column-6
            +preview-xml-java(model, 'clusterRebalance')
