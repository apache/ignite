/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.apache.ignite.internal.processors.cache;

import java.io.IOException;
import java.io.ObjectInput;
import java.io.ObjectOutput;
import org.apache.ignite.internal.dto.IgniteDataTransferObjectSerializer;
import org.apache.ignite.internal.processors.cluster.CacheMetricsMessage;
import org.apache.ignite.internal.util.typedef.internal.U;

/** 
 * This class is implements {@link IgniteDataTransferObjectSerializer}.
 * Most implementation of the interface autogenerated.
 * <b>Please, be aware - serializer works while Rolling Upgrade in progress.</b>
 * All changes must be made with the respece of RU rules.
 *
 * @see org.apache.ignite.internal.codegen.idto.IDTOSerializerFactory
 */
public class CacheMetricsSnapshotSerializer implements IgniteDataTransferObjectSerializer<CacheMetricsSnapshot> {
    /** {@inheritDoc} */
    @Override public void writeExternal(CacheMetricsSnapshot obj, ObjectOutput out) throws IOException {
        out.writeLong(obj.m.cacheGets());
        out.writeLong(obj.m.cachePuts());
        out.writeLong(obj.m.cacheHits());
        out.writeLong(obj.m.cacheMisses());
        out.writeLong(obj.m.cacheTxCommits());
        out.writeLong(obj.m.cacheTxRollbacks());
        out.writeLong(obj.m.cacheEvictions());
        out.writeLong(obj.m.cacheRemovals());

        out.writeFloat(obj.m.averagePutTime());
        out.writeFloat(obj.m.averageGetTime());
        out.writeFloat(obj.m.averageRemoveTime());
        out.writeFloat(obj.m.averageTxCommitTime());
        out.writeFloat(obj.m.averageTxRollbackTime());

        out.writeLong(obj.m.offHeapGets());
        out.writeLong(obj.m.offHeapPuts());
        out.writeLong(obj.m.offHeapRemovals());
        out.writeLong(obj.m.offHeapEvictions());
        out.writeLong(obj.m.offHeapHits());
        out.writeLong(obj.m.offHeapMisses());
        out.writeLong(obj.m.offHeapEntriesCount());
        out.writeLong(obj.m.heapEntriesCount());
        out.writeLong(obj.m.offHeapPrimaryEntriesCount());
        out.writeLong(obj.m.offHeapBackupEntriesCount());
        out.writeLong(obj.m.offHeapAllocatedSize());

        out.writeInt(obj.m.dhtEvictQueueCurrentSize());
        out.writeInt(obj.m.txThreadMapSize());
        out.writeInt(obj.m.txXidMapSize());
        out.writeInt(obj.m.txCommitQueueSize());
        out.writeInt(obj.m.txPrepareQueueSize());
        out.writeInt(obj.m.txStartVersionCountsSize());
        out.writeInt(obj.m.txCommittedVersionsSize());
        out.writeInt(obj.m.txRolledbackVersionsSize());
        out.writeInt(obj.m.txDhtThreadMapSize());
        out.writeInt(obj.m.txDhtXidMapSize());
        out.writeInt(obj.m.txDhtCommitQueueSize());
        out.writeInt(obj.m.txDhtPrepareQueueSize());
        out.writeInt(obj.m.txDhtStartVersionCountsSize());
        out.writeInt(obj.m.txDhtCommittedVersionsSize());
        out.writeInt(obj.m.txDhtRolledbackVersionsSize());
        out.writeInt(obj.m.writeBehindTotalCriticalOverflowCount());
        out.writeInt(obj.m.writeBehindCriticalOverflowCount());
        out.writeInt(obj.m.writeBehindErrorRetryCount());

        out.writeInt(obj.m.totalPartitionsCount());
        out.writeInt(obj.m.rebalancingPartitionsCount());
        out.writeLong(obj.m.keysToRebalanceLeft());
        out.writeLong(obj.m.rebalancingBytesRate());
        out.writeLong(obj.m.rebalancingKeysRate());

        out.writeLong(obj.m.rebalancedKeys());
        out.writeLong(obj.m.estimatedRebalancingKeys());
        out.writeLong(obj.m.rebalancingStartTime());
        out.writeLong(obj.m.rebalanceFinishTime());
        out.writeLong(obj.m.rebalanceClearingPartitionsLeft());

        out.writeLong(obj.m.entryProcessorPuts());
        out.writeFloat(obj.m.entryProcessorAverageInvocationTime());
        out.writeLong(obj.m.entryProcessorInvocations());
        out.writeFloat(obj.m.entryProcessorMaxInvocationTime());
        out.writeFloat(obj.m.entryProcessorMinInvocationTime());
        out.writeLong(obj.m.entryProcessorReadOnlyInvocations());
        out.writeFloat(obj.m.entryProcessorHitPercentage());
        out.writeLong(obj.m.entryProcessorHits());
        out.writeLong(obj.m.entryProcessorMisses());
        out.writeFloat(obj.m.entryProcessorMissPercentage());
        out.writeLong(obj.m.entryProcessorRemovals());

        out.writeLong(obj.m.cacheSize());
        out.writeBoolean(obj.m.empty());
        out.writeInt(obj.m.size());
        out.writeInt(obj.m.keySize());
        U.writeLongString(out, obj.m.txKeyCollisions());
        out.writeInt(obj.m.indexBuildPartitionsLeftCount());
    }

    /** {@inheritDoc} */
    @Override public void readExternal(CacheMetricsSnapshot obj, ObjectInput in) throws IOException, ClassNotFoundException {
        CacheMetricsMessage m = new CacheMetricsMessage();

        m.cacheGets(in.readLong());
        m.cachePuts(in.readLong());
        m.cacheHits(in.readLong());
        m.cacheMisses(in.readLong());
        m.cacheTxCommits(in.readLong());
        m.cacheTxRollbacks(in.readLong());
        m.cacheEvictions(in.readLong());
        m.cacheRemovals(in.readLong());

        m.averagePutTime(in.readFloat());
        m.averageGetTime(in.readFloat());
        m.averageRemoveTime(in.readFloat());
        m.averageTxCommitTime(in.readFloat());
        m.averageTxRollbackTime(in.readFloat());

        m.offHeapGets(in.readLong());
        m.offHeapPuts(in.readLong());
        m.offHeapRemovals(in.readLong());
        m.offHeapEvictions(in.readLong());
        m.offHeapHits(in.readLong());
        m.offHeapMisses(in.readLong());
        m.offHeapEntriesCount(in.readLong());
        m.heapEntriesCount(in.readLong());
        m.offHeapPrimaryEntriesCount(in.readLong());
        m.offHeapBackupEntriesCount(in.readLong());
        m.offHeapAllocatedSize(in.readLong());

        m.dhtEvictQueueCurrentSize(in.readInt());
        m.txThreadMapSize(in.readInt());
        m.txXidMapSize(in.readInt());
        m.txCommitQueueSize(in.readInt());
        m.txPrepareQueueSize(in.readInt());
        m.txStartVersionCountsSize(in.readInt());
        m.txCommittedVersionsSize(in.readInt());
        m.txRolledbackVersionsSize(in.readInt());
        m.txDhtThreadMapSize(in.readInt());
        m.txDhtXidMapSize(in.readInt());
        m.txDhtCommitQueueSize(in.readInt());
        m.txDhtPrepareQueueSize(in.readInt());
        m.txDhtStartVersionCountsSize(in.readInt());
        m.txDhtCommittedVersionsSize(in.readInt());
        m.txDhtRolledbackVersionsSize(in.readInt());
        m.writeBehindTotalCriticalOverflowCount(in.readInt());
        m.writeBehindCriticalOverflowCount(in.readInt());
        m.writeBehindErrorRetryCount(in.readInt());

        m.totalPartitionsCount(in.readInt());
        m.rebalancingPartitionsCount(in.readInt());
        m.keysToRebalanceLeft(in.readLong());
        m.rebalancingBytesRate(in.readLong());
        m.rebalancingKeysRate(in.readLong());

        m.rebalancedKeys(in.readLong());
        m.estimatedRebalancingKeys(in.readLong());
        m.rebalancingStartTime(in.readLong());
        m.rebalanceFinishTime(in.readLong());
        m.rebalanceClearingPartitionsLeft(in.readLong());

        m.entryProcessorPuts(in.readLong());
        m.entryProcessorAverageInvocationTime(in.readFloat());
        m.entryProcessorInvocations(in.readLong());
        m.entryProcessorMaxInvocationTime(in.readFloat());
        m.entryProcessorMinInvocationTime(in.readFloat());
        m.entryProcessorReadOnlyInvocations(in.readLong());
        m.entryProcessorHitPercentage(in.readFloat());
        m.entryProcessorHits(in.readLong());
        m.entryProcessorMisses(in.readLong());
        m.entryProcessorMissPercentage(in.readFloat());
        m.entryProcessorRemovals(in.readLong());

        m.cacheSize(in.readLong());
        m.empty(in.readBoolean());
        m.size(in.readInt());
        m.keySize(in.readInt());
        m.txKeyCollisions(U.readLongString(in));
        m.indexBuildPartitionsLeftCount(in.readInt());
    }
}
