# name: test/sql/types/hugeint/test_hugeint_arithmetic.test
# description: Test arithmetic with huge integers
# group: [hugeint]

statement ok
PRAGMA enable_verification

# negation
query II
SELECT -(100::HUGEINT), -(-(50::HUGEINT));
----
-100	50

# negate 0
query I
SELECT -(0::HUGEINT)
----
0

# negation with large numbers
query II
SELECT -(100000000000000000000::HUGEINT), -(-(100000000000000000000::HUGEINT));
----
-100000000000000000000	100000000000000000000

# addition
# simple addition: small values
query I
SELECT 42::HUGEINT + 42::HUGEINT;
----
84

# negative values
query III
SELECT 42::HUGEINT + -42::HUGEINT, -42::HUGEINT + 100::HUGEINT, -42::HUGEINT+-42::HUGEINT;
----
0	58	-84

# large values
query I
SELECT '100000000000000000000'::HUGEINT + '100000000000000000000'::HUGEINT;
----
200000000000000000000

# large negative values
query I
SELECT '100000000000000000000'::HUGEINT + '-1000000000000000000000'::HUGEINT;
----
-900000000000000000000

query I
SELECT '5'::HUGEINT + '-10000000000000000002'::HUGEINT;
----
-9999999999999999997

# overflow in addition
statement error
SELECT '170141183460469231731687303715884105727'::HUGEINT + '170141183460469231731687303715884105727'::HUGEINT;

statement error
SELECT '170141183460469231731687303715884105727'::HUGEINT + '10'::HUGEINT;

# almost overflowing but not quite
query I
SELECT '170141183460469231731687303715884105727'::HUGEINT - 10::HUGEINT + 10::HUGEINT
----
170141183460469231731687303715884105727

query I
SELECT '-170141183460469231731687303715884105727'::HUGEINT + 10::HUGEINT - 10::HUGEINT
----
-170141183460469231731687303715884105727

# overflowing
statement error
SELECT '170141183460469231731687303715884105727'::HUGEINT - 10::HUGEINT + 11::HUGEINT

statement error
SELECT '-170141183460469231731687303715884105727'::HUGEINT + 10::HUGEINT - 11::HUGEINT

# subtraction
query II
SELECT 100::HUGEINT - 42::HUGEINT, 3::HUGEINT - 5::HUGEINT;
----
58	-2

# negative combinations
query III
SELECT -100::HUGEINT - 42::HUGEINT, -3::HUGEINT - 5::HUGEINT, 12::HUGEINT-(-12::HUGEINT);
----
-142	-8	24

# large subtraction
query I
SELECT '-10000000000000000002'::HUGEINT - '-10000000000000000002'::HUGEINT;
----
0

# underflow in subtraction
statement error
SELECT '-170141183460469231731687303715884105727'::HUGEINT - '170141183460469231731687303715884105727'::HUGEINT;

statement error
SELECT '170141183460469231731687303715884105727'::HUGEINT - '-170141183460469231731687303715884105727'::HUGEINT;

# multiplication
query I
SELECT 100::HUGEINT * 50::HUGEINT;
----
5000

# negative multiplication
query III
SELECT 100::HUGEINT * -50::HUGEINT, -100::HUGEINT * 50::HUGEINT, -100::HUGEINT * -50::HUGEINT;
----
-5000	-5000	5000

# multiplying large numbers
query II
SELECT '1701411834604692317'::HUGEINT * '2'::HUGEINT, '100000000000000000000'::HUGEINT * '1000000000000000000'::HUGEINT
----
3402823669209384634	100000000000000000000000000000000000000

query I
SELECT '170141183460469231731687303715884105727'::HUGEINT * 1::HUGEINT
----
170141183460469231731687303715884105727

# overflow in multiplication
statement error
SELECT '170141183460469231731687303715884105727'::HUGEINT * 2::HUGEINT

statement error
SELECT '1701411834604692317'::HUGEINT * '131687303715884105727'::HUGEINT

# division
query II
SELECT 100::HUGEINT / 20::HUGEINT, 90::HUGEINT / 20::HUGEINT
----
5	4

# negative values
query III
SELECT -100::HUGEINT / 20::HUGEINT, 100::HUGEINT / -20::HUGEINT, -100::HUGEINT / -20::HUGEINT
----
-5	-5	5

# division by zero
query I
SELECT 100::HUGEINT / 0::HUGEINT
----
NULL

# large values
query II
SELECT '100000000000000000000000000000000000000'::HUGEINT / '10000000000000'::HUGEINT, '100000000000000000000000000000000000000'::HUGEINT / '2'::HUGEINT
----
10000000000000000000000000	50000000000000000000000000000000000000

# modulo
query II
SELECT 100::HUGEINT % 20::HUGEINT, 90::HUGEINT % 20::HUGEINT
----
0	10

# negative values
query III
SELECT -90 % 20, 90 % -20, -90 % -20
----
-10	10	-10

query III
SELECT -90::HUGEINT % 20::HUGEINT, 90::HUGEINT % -20::HUGEINT, -90::HUGEINT % -20::HUGEINT
----
-10	10	-10

# modulo by zero
query I
SELECT 100::HUGEINT % 0::HUGEINT
----
NULL

# large values
query II
SELECT '100000000000000000000000000000000000000'::HUGEINT % '6587689457689375689735'::HUGEINT, '100000000000000000000000000000000000000'::HUGEINT % '3'::HUGEINT
----
5396771390320972230850	1

# abs
query II
SELECT ABS('100'::HUGEINT), ABS('-100'::HUGEINT);;
----
100	100
