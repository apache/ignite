# name: test/sql/function/timestamp/test_extract.test
# description: Extract timestamp function
# group: [timestamp]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE timestamps(ii TIMESTAMP)

statement ok
INSERT INTO timestamps VALUES ('1993-08-14 08:22:33'), (NULL)

# extract various parts of the timestamp
query I
SELECT EXTRACT(year FROM ii) FROM timestamps
----
1993
NULL

query I
SELECT EXTRACT(month FROM ii) FROM timestamps
----
8
NULL

query I
SELECT EXTRACT(day FROM ii) FROM timestamps
----
14
NULL

query I
SELECT EXTRACT(decade FROM ii) FROM timestamps
----
199
NULL

query I
SELECT EXTRACT(century FROM ii) FROM timestamps
----
20
NULL

# day of the week (Sunday = 0, Saturday = 6)
query I
SELECT EXTRACT(DOW FROM ii) FROM timestamps
----
6
NULL

# day of the year (1 - 365/366)
query I
SELECT EXTRACT(DOY FROM ii) FROM timestamps
----
226
NULL

query I
SELECT EXTRACT(epoch FROM ii) FROM timestamps
----
745316553
NULL

# isodow (Monday = 1, Sunday = 7)
query I
SELECT EXTRACT(ISODOW FROM ii) FROM timestamps
----
6
NULL

# millenium (change of millenium is January 1, X001)
query I
SELECT EXTRACT(millennium FROM ii) FROM timestamps
----
2
NULL

query I
SELECT EXTRACT(second FROM ii) FROM timestamps
----
33
NULL

query I
SELECT EXTRACT(minute FROM ii) FROM timestamps
----
22
NULL

query I
SELECT EXTRACT(hour FROM ii) FROM timestamps
----
8
NULL

query I
SELECT EXTRACT(milliseconds FROM ii) FROM timestamps
----
33000
NULL

