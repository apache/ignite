# name: test/sql/function/operator/test_conjunction.test
# description: Test conjunction statements
# group: [operator]

statement ok
PRAGMA enable_verification

# create table
statement ok
CREATE TABLE aa (ii integer, jj integer);

statement ok
INSERT INTO aa VALUES (3, 4), (4, 5), (5, 6)

query II
SELECT * FROM aa WHERE (ii > 3 AND jj < 5) OR (ii > 3 AND jj > 5)
----
5	6

# test boolean logic in conjunctions
query T
SELECT true AND true
----
1

query T
SELECT true AND false
----
0

query T
SELECT false AND true
----
0

query T
SELECT false AND false
----
0

query T
SELECT false AND NULL
----
0

query T
SELECT NULL AND false
----
0

query T
SELECT NULL AND true
----
NULL

query T
SELECT true AND NULL
----
NULL

query T
SELECT true OR true
----
1

query T
SELECT true OR NULL
----
1

query T
SELECT NULL OR true
----
1

query T
SELECT false OR NULL
----
NULL

query T
SELECT NULL OR false
----
NULL

query T
SELECT true OR false
----
1

query T
SELECT false OR true
----
1

query T
SELECT false OR false
----
0

# test single constant in conjunctions
query T
SELECT true AND ii>3 FROM aa ORDER BY ii
----
0
1
1

query T
SELECT ii>3 AND true FROM aa ORDER BY ii
----
0
1
1

query T
SELECT 2>3 AND ii>3 FROM aa ORDER BY ii
----
0
0
0

query T
SELECT false AND ii>3 FROM aa ORDER BY ii
----
0
0
0

query T
SELECT ii>3 AND false FROM aa ORDER BY ii
----
0
0
0

query T
SELECT false OR ii>3 FROM aa ORDER BY ii
----
0
1
1

query T
SELECT ii>3 OR false FROM aa ORDER BY ii
----
0
1
1

query T
SELECT true OR ii>3 FROM aa ORDER BY ii
----
1
1
1

query T
SELECT ii>3 OR true FROM aa ORDER BY ii
----
1
1
1

query T
SELECT NULL OR ii>3 FROM aa ORDER BY ii
----
NULL
1
1

query T
SELECT ii>3 OR NULL FROM aa ORDER BY ii
----
NULL
1
1

query T
SELECT NULL AND ii>3 FROM aa ORDER BY ii
----
0
NULL
NULL

query T
SELECT ii>3 AND NULL FROM aa ORDER BY ii
----
0
NULL
NULL

