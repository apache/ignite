# name: test/sql/function/generic/test_in.test
# description: Test IN statement
# group: [generic]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE integers(ii INTEGER)

statement ok
INSERT INTO integers VALUES (1), (2), (3), (NULL);

query I
SELECT * FROM integers WHERE ii IN (1, 2) ORDER BY ii
----
1
2

query I
SELECT * FROM integers WHERE ii IN (1, 2, 3, 4, 5, 6, 7, 8) ORDER BY ii
----
1
2
3

query IT
SELECT ii, ii IN (1, 2, 3, 4, 5, 6, 7, 8) FROM integers ORDER BY ii
----
NULL	NULL
1	1
2	1
3	1

query IT
SELECT ii, ii NOT IN (1, 2, 3, 4, 5, 6, 7, 8) FROM integers ORDER BY ii
----
NULL	NULL
1	0
2	0
3	0

query IT
SELECT ii, ii IN (1, 2, NULL, 4, 5, 6, 7, 8) FROM integers ORDER BY ii
----
NULL	NULL
1	1
2	1
3	NULL

query IT
SELECT ii, ii IN (ii + 1) FROM integers ORDER BY ii
----
NULL	NULL
1	0
2	0
3	0

query IT
SELECT ii, ii IN (ii + 1, 42, ii) FROM integers ORDER BY ii
----
NULL	NULL
1	1
2	1
3	1

query IT
SELECT ii, 1 IN (ii - 1, ii, ii + 1) FROM integers ORDER BY ii
----
NULL	NULL
1	1
2	1
3	0

query IT
SELECT ii, 1 NOT IN (ii - 1, ii, ii + 1) FROM integers ORDER BY ii
----
NULL	NULL
1	0
2	0
3	1

query IT
SELECT ii, ii IN (11, 12, 13, 14, 15, 16, 17, 18, 1, ii) FROM integers ORDER BY ii
----
NULL	NULL
1	1
2	1
3	1

query IT
SELECT ii, ii NOT IN (11, 12, 13, 14, 15, 16, 17, 18, 1, ii) FROM integers ORDER BY ii
----
NULL	NULL
1	0
2	0
3	0

query IT
SELECT ii, 1 IN (11, 12, 13, 14, 15, 16, 17, 18, 1, ii) FROM integers ORDER BY ii
----
NULL	1
1	1
2	1
3	1

query IT
SELECT ii, 1 NOT IN (11, 12, 13, 14, 15, 16, 17, 18, 1, ii) FROM integers ORDER BY ii
----
NULL	0
1	0
2	0
3	0

query IT
SELECT ii, ii IN ((SELECT MAX(ii) FROM integers), (SELECT MIN(ii) FROM integers)) FROM integers ORDER BY ii
----
NULL	NULL
1	1
2	0
3	1

query III
SELECT ii, (SELECT MAX(ii) FROM integers WHERE ii <> i1.ii), (SELECT MIN(ii) FROM integers WHERE ii <= i1.ii) FROM integers i1 ORDER BY ii
----
NULL	NULL	NULL
1	3	1
2	3	1
3	2	1

query IT
SELECT ii, ii IN ((SELECT MAX(ii) FROM integers WHERE ii <> i1.ii), (SELECT MIN(ii) FROM integers WHERE ii <= i1.ii)) FROM integers i1 ORDER BY ii
----
NULL	NULL
1	1
2	0
3	0

