# name: test/sql/function/generic/test_null_if.test
# description: Test NULL IF statement
# group: [generic]

statement ok
PRAGMA enable_verification

# NULL IF
query T
SELECT NULLIF(NULLIF ('hello', 'world'), 'blabla');
----
hello

# NULL IF with subquery
statement ok
CREATE TABLE test (aa STRING);

statement ok
INSERT INTO test VALUES ('hello'), ('world'), ('test')

statement ok
CREATE TABLE test2 (aa STRING, bb STRING);

statement ok
INSERT INTO test2 VALUES ('blabla', 'bb'), ('blabla2', 'cc'), ('blabla3', 'd')

query T
SELECT NULLIF(NULLIF ((SELECT aa FROM test LIMIT 1 offset 1), aa), bb) FROM test2
----
world
world
world

statement ok
DROP TABLE test;

# NULL IF with strings
statement ok
CREATE TABLE test3 (aa INTEGER, bb INTEGER);

statement ok
INSERT INTO test3 VALUES (11, 22), (13, 22), (12, 21)

query T
SELECT NULLIF(CAST(aa AS VARCHAR), 11) FROM test3;
----
NULL
13
12

query IT
SELECT aa, CASE WHEN aa>11 THEN CAST(aa AS VARCHAR) ELSE CAST(bb AS VARCHAR) END FROM test3 ORDER BY 1;
----
11	22
12	12
13	13

