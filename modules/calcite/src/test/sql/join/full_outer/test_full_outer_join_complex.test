# name: test/sql/join/full_outer/test_full_outer_join_complex.test
# description: Test complex FULL OUTER JOIN
# group: [full_outer]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE integers(ii INTEGER, jj INTEGER)

statement ok
INSERT INTO integers VALUES (1, 1)

statement ok
CREATE TABLE integers2(kk INTEGER, l INTEGER)

statement ok
INSERT INTO integers2 VALUES (1, 10)

query IIII
SELECT ii, jj, kk, l FROM integers FULL OUTER JOIN integers2 ON integers.ii+integers2.kk+9<>integers.jj+integers2.l ORDER BY 1, 2, 3, 4
----
NULL	NULL	1	10
1	1	NULL	NULL

# empty RHS
query IIII
SELECT ii, jj, kk, l FROM integers FULL OUTER JOIN (SELECT * FROM integers2 WHERE 1=0) integers2 ON integers.ii+integers2.kk+9<>integers.jj+integers2.l ORDER BY 1, 2, 3, 4
----
1	1	NULL	NULL

