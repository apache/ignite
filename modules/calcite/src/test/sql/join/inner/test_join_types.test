# name: test/sql/join/inner/test_join_types.test
# description: Test joins with different types
# group: [inner]

statement ok
PRAGMA enable_verification

# numeric types
# tests for tinyint
statement ok
begin transaction

statement ok
create table aa as select ii::tinyint AS ii from range(1, 101, 1) t1(ii)

# range joins
query IR
select count(*), sum(ii) from aa, (SELECT 100::tinyint AS jj) bb where ii < jj
----
99	4950.000000

query I
select count(*) from aa, (SELECT 100::tinyint AS jj) bb where ii <= jj
----
100

query I
select count(*) from aa, (SELECT 1::tinyint AS jj) bb where ii > jj
----
99

query I
select count(*) from aa, (SELECT 1::tinyint AS jj) bb where ii >= jj
----
100

# inequality join
query I
select count(*) from aa, (SELECT 1::tinyint AS jj) bb where ii <> jj
----
99

# equality join
query I
select count(*) from aa, (SELECT 1::tinyint AS jj) bb where ii = jj
----
1

# no results on one side
query I
select count(*) from aa, (SELECT 1::tinyint AS jj) bb where ii > jj AND ii>1000
----
0

query I
select count(*) from aa, (SELECT 1::tinyint AS jj) bb where ii <> jj AND ii>1000
----
0

query I
select count(*) from aa, (SELECT 1::tinyint AS jj) bb where ii = jj AND ii>1000
----
0

statement ok
rollback

# tests for smallint
statement ok
begin transaction

statement ok
create table aa as select ii::smallint AS ii from range(1, 101, 1) t1(ii)

# range joins
query IR
select count(*), sum(ii) from aa, (SELECT 100::smallint AS jj) bb where ii < jj
----
99	4950.000000

query I
select count(*) from aa, (SELECT 100::smallint AS jj) bb where ii <= jj
----
100

query I
select count(*) from aa, (SELECT 1::smallint AS jj) bb where ii > jj
----
99

query I
select count(*) from aa, (SELECT 1::smallint AS jj) bb where ii >= jj
----
100

# inequality join
query I
select count(*) from aa, (SELECT 1::smallint AS jj) bb where ii <> jj
----
99

# equality join
query I
select count(*) from aa, (SELECT 1::smallint AS jj) bb where ii = jj
----
1

# no results on one side
query I
select count(*) from aa, (SELECT 1::smallint AS jj) bb where ii > jj AND ii>1000
----
0

query I
select count(*) from aa, (SELECT 1::smallint AS jj) bb where ii <> jj AND ii>1000
----
0

query I
select count(*) from aa, (SELECT 1::smallint AS jj) bb where ii = jj AND ii>1000
----
0

statement ok
rollback

# tests for integer
statement ok
begin transaction

statement ok
create table aa as select ii::integer AS ii from range(1, 101, 1) t1(ii)

# range joins
query IR
select count(*), sum(ii) from aa, (SELECT 100::integer AS jj) bb where ii < jj
----
99	4950.000000

query I
select count(*) from aa, (SELECT 100::integer AS jj) bb where ii <= jj
----
100

query I
select count(*) from aa, (SELECT 1::integer AS jj) bb where ii > jj
----
99

query I
select count(*) from aa, (SELECT 1::integer AS jj) bb where ii >= jj
----
100

# inequality join
query I
select count(*) from aa, (SELECT 1::integer AS jj) bb where ii <> jj
----
99

# equality join
query I
select count(*) from aa, (SELECT 1::integer AS jj) bb where ii = jj
----
1

# no results on one side
query I
select count(*) from aa, (SELECT 1::integer AS jj) bb where ii > jj AND ii>1000
----
0

query I
select count(*) from aa, (SELECT 1::integer AS jj) bb where ii <> jj AND ii>1000
----
0

query I
select count(*) from aa, (SELECT 1::integer AS jj) bb where ii = jj AND ii>1000
----
0

statement ok
rollback

# tests for bigint
statement ok
begin transaction

statement ok
create table aa as select ii::bigint AS ii from range(1, 101, 1) t1(ii)

# range joins
query IR
select count(*), sum(ii) from aa, (SELECT 100::bigint AS jj) bb where ii < jj
----
99	4950.000000

query I
select count(*) from aa, (SELECT 100::bigint AS jj) bb where ii <= jj
----
100

query I
select count(*) from aa, (SELECT 1::bigint AS jj) bb where ii > jj
----
99

query I
select count(*) from aa, (SELECT 1::bigint AS jj) bb where ii >= jj
----
100

# inequality join
query I
select count(*) from aa, (SELECT 1::bigint AS jj) bb where ii <> jj
----
99

# equality join
query I
select count(*) from aa, (SELECT 1::bigint AS jj) bb where ii = jj
----
1

# no results on one side
query I
select count(*) from aa, (SELECT 1::bigint AS jj) bb where ii > jj AND ii>1000
----
0

query I
select count(*) from aa, (SELECT 1::bigint AS jj) bb where ii <> jj AND ii>1000
----
0

query I
select count(*) from aa, (SELECT 1::bigint AS jj) bb where ii = jj AND ii>1000
----
0

statement ok
rollback

# tests for real
statement ok
begin transaction

statement ok
create table aa as select ii::real AS ii from range(1, 101, 1) t1(ii)

# range joins
query IR
select count(*), sum(ii) from aa, (SELECT 100::real AS jj) bb where ii < jj
----
99	4950.000000

query I
select count(*) from aa, (SELECT 100::real AS jj) bb where ii <= jj
----
100

query I
select count(*) from aa, (SELECT 1::real AS jj) bb where ii > jj
----
99

query I
select count(*) from aa, (SELECT 1::real AS jj) bb where ii >= jj
----
100

# inequality join
query I
select count(*) from aa, (SELECT 1::real AS jj) bb where ii <> jj
----
99

# equality join
query I
select count(*) from aa, (SELECT 1::real AS jj) bb where ii = jj
----
1

# no results on one side
query I
select count(*) from aa, (SELECT 1::real AS jj) bb where ii > jj AND ii>1000
----
0

query I
select count(*) from aa, (SELECT 1::real AS jj) bb where ii <> jj AND ii>1000
----
0

query I
select count(*) from aa, (SELECT 1::real AS jj) bb where ii = jj AND ii>1000
----
0

statement ok
rollback

# tests for double
statement ok
begin transaction

statement ok
create table aa as select ii::double AS ii from range(1, 101, 1) t1(ii)

# range joins
query IR
select count(*), sum(ii) from aa, (SELECT 100::double AS jj) bb where ii < jj
----
99	4950.000000

query I
select count(*) from aa, (SELECT 100::double AS jj) bb where ii <= jj
----
100

query I
select count(*) from aa, (SELECT 1::double AS jj) bb where ii > jj
----
99

query I
select count(*) from aa, (SELECT 1::double AS jj) bb where ii >= jj
----
100

# inequality join
query I
select count(*) from aa, (SELECT 1::double AS jj) bb where ii <> jj
----
99

# equality join
query I
select count(*) from aa, (SELECT 1::double AS jj) bb where ii = jj
----
1

# no results on one side
query I
select count(*) from aa, (SELECT 1::double AS jj) bb where ii > jj AND ii>1000
----
0

query I
select count(*) from aa, (SELECT 1::double AS jj) bb where ii <> jj AND ii>1000
----
0

query I
select count(*) from aa, (SELECT 1::double AS jj) bb where ii = jj AND ii>1000
----
0

statement ok
rollback

# strings
statement ok
begin transaction

statement ok
create table aa (ii VARCHAR)

statement ok
insert into aa values ('aa'), ('bb'), ('cc'), ('d'), ('e'), ('f')

# range joins
query I
select count(*) from aa, (SELECT 'f' AS jj) bb where ii < jj
----
5

query I
select count(*) from aa, (SELECT 'f' AS jj) bb where ii <= jj
----
6

query I
select count(*) from aa, (SELECT 'aa' AS jj) bb where ii > jj
----
5

query I
select count(*) from aa, (SELECT 'aa' AS jj) bb where ii >= jj
----
6

query I
select count(*) from aa, (SELECT 'aa' AS jj) bb where ii <> jj
----
5

query I
select count(*) from aa, (SELECT 'aa' AS jj) bb where ii = jj
----
1

statement ok
rollback

