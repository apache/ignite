# name: test/sql/join/inner/test_range_join.test
# description: Test range joins
# group: [inner]

statement ok
PRAGMA enable_verification

# create tables
statement ok
CREATE TABLE test (aa INTEGER, bb INTEGER);

statement ok
INSERT INTO test VALUES (11, 1), (12, 2), (13, 3)

statement ok
CREATE TABLE test2 (bb INTEGER, cc INTEGER);

statement ok
INSERT INTO test2 VALUES (1, 10), (1, 20), (2, 30)

query II
SELECT test.bb, test2.bb FROM test, test2 WHERE test.bb<test2.bb
----
1	2

query II
SELECT test.bb, test2.bb FROM test, test2 WHERE test.bb <= test2.bb ORDER BY 1,2
----
1	1
1	1
1	2
2	2

# range join on multiple predicates
query IIII
SELECT test.aa, test.bb, test2.bb, test2.cc FROM test, test2 WHERE test.aa>test2.cc AND test.bb <= test2.bb
----
11	1	1	10

# introduce some NULL values
statement ok
INSERT INTO test VALUES (11, NULL), (NULL, 1)

# join result should be unchanged
query IIII
SELECT test.aa, test.bb, test2.bb, test2.cc FROM test, test2 WHERE test.aa>test2.cc AND test.bb <= test2.bb
----
11	1	1	10

# on the RHS as well
statement ok
INSERT INTO test2 VALUES (1, NULL), (NULL, 10)

# join result should be unchanged
query IIII
SELECT test.aa, test.bb, test2.bb, test2.cc FROM test, test2 WHERE test.aa>test2.cc AND test.bb <= test2.bb
----
11	1	1	10

