# name: test/sql/join/inner/test_using_chain.test
# description: Test chaining USING joins
# group: [inner]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE t1 (aa INTEGER, bb INTEGER)

statement ok
INSERT INTO t1 VALUES (1, 2)

statement ok
CREATE TABLE t2 (bb INTEGER, cc INTEGER)

statement ok
INSERT INTO t2 VALUES (2, 3)

statement ok
CREATE TABLE t3 (cc INTEGER, d INTEGER)

statement ok
INSERT INTO t3 VALUES (3, 4)

# multiple joins with using
# single column
query IIII
SELECT * FROM t1 JOIN t2 USING (bb) JOIN t3 USING (cc) ORDER BY 1, 2, 3, 4;
----
1	2	3	4

# column does not exist on left side of join
statement error
SELECT * FROM t1 JOIN t2 USING (cc)

# column does not exist on right side of join
statement error
SELECT * FROM t1 JOIN t2 USING (aa)

statement ok
DROP TABLE t1

statement ok
DROP TABLE t2

statement ok
DROP TABLE t3

statement ok
CREATE TABLE t1 (aa INTEGER, bb INTEGER, cc INTEGER)

statement ok
INSERT INTO t1 VALUES (1, 2, 2)

statement ok
CREATE TABLE t2 (bb INTEGER, cc INTEGER, d INTEGER, e INTEGER)

statement ok
INSERT INTO t2 VALUES (2, 2, 3, 4)

statement ok
CREATE TABLE t3 (d INTEGER, e INTEGER)

statement ok
INSERT INTO t3 VALUES (3, 4)

# multi column
query IIIII
SELECT * FROM t1 JOIN t2 USING (bb, cc) JOIN t3 USING (d, e);
----
1	2	2	3	4

