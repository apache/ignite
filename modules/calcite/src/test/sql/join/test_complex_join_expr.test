# name: test/sql/join/test_complex_join_expr.test
# description: Test joins with comparisons involving both sides of the join
# group: [join]

statement ok
PRAGMA enable_verification

# create tables
statement ok
CREATE TABLE test (aa INTEGER, bb INTEGER);

statement ok
INSERT INTO test VALUES (4, 1), (2, 2)

statement ok
CREATE TABLE test2 (bb INTEGER, cc INTEGER);

statement ok
INSERT INTO test2 VALUES (1, 2), (3, 0)

query IIII
SELECT * FROM test JOIN test2 ON test.aa+test2.cc=test.bb+test2.bb
----
4	1	3	0

query IIII
SELECT * FROM test LEFT JOIN test2 ON test.aa+test2.cc=test.bb+test2.bb ORDER BY 1
----
2	2	NULL	NULL
4	1	3	0

query IIII
SELECT * FROM test RIGHT JOIN test2 ON test.aa+test2.cc=test.bb+test2.bb ORDER BY 1
----
NULL	NULL	1	2
4	1	3	0

