# name: test/sql/insert/null_values.test
# description: Test inserting many null values
# group: [insert]

statement ok
CREATE TABLE integers(ii INTEGER)

statement ok
INSERT INTO integers SELECT ii FROM range(100) tbl(ii);

statement ok
BEGIN TRANSACTION

loop ii 0 5

statement ok
INSERT INTO integers SELECT ii FROM range(100) tbl(ii);

statement ok
INSERT INTO integers SELECT NULL FROM range(100) tbl(ii);

endloop

query IIIII
SELECT COUNT(ii), SUM(ii), MIN(ii), MAX(ii), COUNT(*) FROM integers
----
600	29700	0	99	1100

statement ok
COMMIT

query IIIII
SELECT COUNT(ii), SUM(ii), MIN(ii), MAX(ii), COUNT(*) FROM integers
----
600	29700	0	99	1100

query I
SELECT SUM(CASE WHEN ii IS NULL THEN 1 ELSE 0 END) FROM integers
----
500