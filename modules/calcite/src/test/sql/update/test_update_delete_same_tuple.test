# name: test/sql/update/test_update_delete_same_tuple.test
# description: Test update and delete of the same tuple
# group: [update]

# on aa normal table, we can update and delete the same tuple concurrently without aa conflict
statement ok con1
CREATE TABLE test (aa INTEGER);

statement ok con1
INSERT INTO test VALUES (1), (2), (3);

statement ok con1
BEGIN TRANSACTION;

statement ok con2
BEGIN TRANSACTION;

statement ok con1
UPDATE test SET aa=aa+1;

statement ok con2
DELETE FROM test

query I con1
SELECT * FROM test ORDER BY aa
----
2
3
4

query I con2
SELECT * FROM test ORDER BY aa
----

statement ok con1
COMMIT;

statement ok con2
COMMIT;

statement ok con1
DROP TABLE test;

