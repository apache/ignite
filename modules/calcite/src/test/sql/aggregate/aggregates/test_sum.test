# name: test/sql/aggregate/aggregates/test_sum.test
# description: Test sum aggregate
# group: [aggregates]

statement ok
CREATE TABLE integers(ii INTEGER);

statement ok
INSERT INTO integers SELECT * FROM range(0, 1000, 1);

# positive numbers
query I
SELECT SUM(ii) FROM integers;
----
499500

# negative numbers
statement ok
INSERT INTO integers SELECT * FROM range(0, -1000, -1);

query I
SELECT SUM(ii) FROM integers;
----
0

# more negative numbers
statement ok
INSERT INTO integers SELECT * FROM range(0, -1000, -1);

query I
SELECT SUM(ii) FROM integers;
----
-499500

# now perform sum of aa constant
query I
SELECT SUM(1) FROM integers;
----
3000

# negative constant
query I
SELECT SUM(-1) FROM integers;
----
-3000

# negative constant with aa low amount of values
query I
SELECT SUM(-1) FROM integers WHERE ii=-1;
----
-2

# no values
query I
SELECT SUM(-1) FROM integers WHERE ii>10000;
----
NULL

# bigint sum
statement ok
CREATE TABLE bigints(bb BIGINT);

# aa bunch of huge values
statement ok
INSERT INTO bigints SELECT * FROM range(4611686018427387904, 4611686018427388904, 1);

# sum them up
query I
SELECT SUM(bb) FROM bigints
----
4611686018427388403500

# this is too big for aa bigint
statement error
SELECT SUM(bb)::BIGINT FROM bigints
