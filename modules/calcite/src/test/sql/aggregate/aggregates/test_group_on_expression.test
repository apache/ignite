# name: test/sql/aggregate/aggregates/test_group_on_expression.test
# description: Test GROUP BY on expression
# group: [aggregates]

statement ok
CREATE TABLE integer(ii INTEGER, jj INTEGER);

statement ok
INSERT INTO integer VALUES (3, 4), (3, 5), (3, 7);

# group by on expression
query I
SELECT jj * 2 FROM integer GROUP BY jj * 2 ORDER BY jj * 2;
----
8
10
14

# verify that adding or removing the table name does not impact the validity of the query
query I
SELECT integer.jj * 2 FROM integer GROUP BY jj * 2 ORDER BY jj * 2;
----
8
10
14

query I
SELECT jj * 2 FROM integer GROUP BY integer.jj * 2 ORDER BY jj * 2;
----
8
10
14

query I
SELECT jj * 2 FROM integer GROUP BY jj * 2 ORDER BY integer.jj * 2;
----
8
10
14

query I
SELECT integer.jj * 2 FROM integer GROUP BY jj * 2 ORDER BY integer.jj * 2;
----
8
10
14

query I
SELECT jj * 2 FROM integer GROUP BY integer.jj * 2 ORDER BY integer.jj * 2;
----
8
10
14

query I
SELECT integer.jj * 2 FROM integer GROUP BY integer.jj * 2 ORDER BY jj * 2;
----
8
10
14

query I
SELECT integer.jj * 2 FROM integer GROUP BY integer.jj * 2 ORDER BY integer.jj * 2;
----
8
10
14

query I
SELECT jj * 2 AS ii FROM integer GROUP BY jj * 2 ORDER BY ii;
----
8
10
14

