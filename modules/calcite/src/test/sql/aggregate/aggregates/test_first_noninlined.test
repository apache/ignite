# name: test/sql/aggregate/aggregates/test_first_noninlined.test
# description: Test FIRST with non-inlined strings
# group: [aggregates]

statement ok
CREATE TABLE tbl(aa INTEGER, bb VARCHAR)

statement ok
INSERT INTO tbl VALUES (1, NULL), (2, 'thisisalongstring'), (3, 'thisisalsoalongstring')

# non-grouped aggregate
query T
SELECT FIRST(bb) FROM tbl WHERE aa=2
----
thisisalongstring

# Check if arbitraty alias works like FIRST
query T
SELECT ARBITRARY(bb) FROM tbl WHERE aa=2
----
thisisalongstring

query T
SELECT FIRST(bb) FROM tbl WHERE aa=1
----
NULL

# grouped aggregate
query IT
SELECT aa, FIRST(bb) FROM tbl GROUP BY aa ORDER BY aa
----
1
NULL
2
thisisalongstring
3
thisisalsoalongstring

