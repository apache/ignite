# name: test/sql/aggregate/aggregates/test_product.test
# description: Test Product operator
# group: [aggregates]

#Corner cases
statement error
select product()

query I
select product(NULL)
----
NULL

query I
select product(1)
----
1

statement error
select product(*)

statement ok
CREATE TABLE integers(ii INTEGER);

statement ok
INSERT INTO integers VALUES (1), (2),(4), (NULL)

query I
SELECT product(ii)  FROM integers
----
8

query I
SELECT PRODUCT(2) FROM range(100);
----
1267650600228229401496703205376

query I
SELECT PRODUCT(2) FROM range(100) tbl(ii) WHERE ii % 2 != 0;
----
1125899906842624

# Grouped Aggregation
query I
select product(ii) from integers group by ii%2
----
1.000000
8.000000
NULL

# Empty Table
query I
SELECT PRODUCT(ii) FROM range(100) tbl(ii) WHERE 1=0;
----
NULL

# Window Function
require vector_size 512

query I rowsort
select product(ii) over (partition by ii%2)
    from integers;
----
1
8
8
NULL

