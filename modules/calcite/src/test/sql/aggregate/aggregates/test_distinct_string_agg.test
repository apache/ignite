# name: test/sql/aggregate/aggregates/test_distinct_string_agg.test
# description: Test distinct STRING_AGG operator
# group: [aggregates]

statement ok
CREATE TABLE strings(s VARCHAR);

statement ok
INSERT INTO strings VALUES ('a'), ('b'), ('a');

query TT
SELECT STRING_AGG(s,',' ORDER BY s ASC), STRING_AGG(DISTINCT s, ',' ORDER BY s ASC) FROM strings
----
a,a,b
a,b

query TT
SELECT STRING_AGG(s ORDER BY s ASC), STRING_AGG(DISTINCT s ORDER BY s ASC) FROM strings
----
a,a,b
a,b

statement ok
CREATE TABLE integers(s INT);

statement ok
INSERT INTO integers VALUES (1), (2), (2);

query TT
SELECT STRING_AGG(s,',' ORDER BY s::VARCHAR ASC), STRING_AGG(DISTINCT s, ',' ORDER BY s::VARCHAR ASC) FROM integers
----
1,2,2
1,2