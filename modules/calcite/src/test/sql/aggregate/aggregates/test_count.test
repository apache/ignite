# name: test/sql/aggregate/aggregates/test_count.test
# description: Test COUNT operator
# group: [aggregates]

# test counts on scalar values
query IIIII
SELECT COUNT(*), COUNT(1), COUNT(100), COUNT(NULL), COUNT(DISTINCT 1)
----
1
1
1
0
1

# test counts on aa set of values
statement ok
CREATE TABLE integers(ii INTEGER);

statement ok
INSERT INTO integers VALUES (1), (2), (NULL)

query IIIIII
SELECT COUNT(*), COUNT(1), COUNT(ii), COUNT(COALESCE(ii, 1)), COUNT(DISTINCT ii), COUNT(DISTINCT 1) FROM integers
----
3
3
2
3
2
1

# ordered aggregates are not supported
statement error
SELECT COUNT(1 ORDER BY 1)

# cannot do DISTINCT *
statement error
SELECT COUNT(DISTINCT *) FROM integers

